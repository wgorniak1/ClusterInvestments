/*! nav - v0.3.1 - 2014-04-15
* https://github.com/kaptinlin/nav
* Copyright (c) 2014 kaptinlin; Licensed GPL */
(function(t,i){"use strict";var e="nav",n=i.nav=function(t,s){function o(){n.windowDimensions=u.getWindowDimensions(),f(),i(window).bind("resize",u.resize)}function f(){a=!0;var t=u.$nav.find("> li");r(t,u.settings.root),r(t.find("li"),u.settings.child)}function r(t,e){u.hover(t,e.hoverIntent,e.delay,function(){var t=this,s=i(this).find("> ul");if(e.beforeHoverIn.call(t),s.size()>0){var o=i(t).data("check");o===undefined&&e.beforeFirstRender.call(t),(o===undefined||o!==n.windowDimensions)&&(e.position.call(t,s,u),i(t).data("check",n.windowDimensions)),"fade"===e.effect?s.hide().css("visibility","visible").fadeIn(e.inDuration,function(){e.afterHoverIn.call(t)}):s.hide().css("visibility","visible").slideDown(e.inDuration,function(){e.afterHoverIn.call(t)})}else e.afterHoverIn.call(t)},function(){var t=this,n=i(this).find("> ul");e.beforeHoverOut.call(t),n.size()>0?"fade"===e.effect?n.fadeOut(e.outDuration,function(){n.css("visibility","hidden"),e.afterHoverOut.call(t)}):n.slideUp(e.outDuration,function(){n.css("visibility","hidden"),e.afterHoverOut.call(t)}):e.afterHoverOut.call(t)})}this.nav=t,this.$nav=i(t),this.settings=i.extend(!0,{},n.defaults,s);var a=!1,u=this;null==this.settings.rtl&&(this.settings.rtl=function(t){if("rtl"===(""+t.attr("dir")).toLowerCase())return!0;var e=!1;return t.parents("[dir]").each(function(){return/rtl/i.test(i(this).attr("dir"))?(e=!0,!1):undefined}),e}(this.$nav)),this.settings.rtl?(this.dirAttribute="right",this.$nav.addClass(e+"_rtl")):this.dirAttribute="left",i.extend(u,{getNav:function(){return this.$nav},getCurrent:function(){var t=this.$nav.find(this.settings.currentSelector);return 0===t.size()&&(t=this.$nav.find("li:first")),t.find("> a")},getWindowDimensions:function(){return{w:i(window).width(),h:i(window).height()}},resize:function(){n.windowDimensions=u.getWindowDimensions()},isBuilted:function(){return a},hover:function(t,e,n,s,o){i.fn.hoverIntent!==undefined?i(t).hoverIntent({sensitivity:30,interval:e,timeout:n,over:s,out:o}):i(t).hover(s,o)}}),o()};n.defaults={root:{effect:"slide",delay:100,hoverIntent:100,inDuration:200,outDuration:200,beforeHoverIn:function(){},afterHoverIn:function(){i(this).addClass("is-open")},beforeHoverOut:function(){},afterHoverOut:function(){i(this).removeClass("is-open")},beforeFirstRender:function(){},position:function(t,e){var s=this,o=i(this),f={left:o.offset().left,top:o.offset().top},r={w:t.outerWidth(),h:t.outerHeight()};e.settings.rtl?f.left>r.w?t.css({right:0}):f.left+s.offsetWidth<r.w?t.css({right:-r.w+s.offsetWidth}):t.css({right:"auto",left:0}):f.left+r.w<n.windowDimensions.w?t.css({left:0}):f.left+s.offsetWidth<r.w?f.left<n.windowDimensions.w/2?t.css({left:-f.left+e.$nav.offset().left}):t.css({left:n.windowDimensions.w-f.left-r.w-e.$nav.offset().left}):t.css({left:"auto",right:0})}},child:{effect:"fade",delay:150,hoverIntent:0,inDuration:200,outDuration:200,beforeHoverIn:function(){},afterHoverIn:function(){i(this).addClass("is-open")},beforeHoverOut:function(){},afterHoverOut:function(){i(this).removeClass("is-open")},beforeFirstRender:function(){},position:function(t,e){var s=this,o=i(s),f={left:o.offset().left,top:o.offset().top},r={w:t.outerWidth(),h:t.outerHeight()};e.settings.rtl?s.offsetWidth<f.left?t.css({right:s.offsetWidth}):t.css({right:0-s.offsetWidth}):f.left+s.offsetWidth+r.w<n.windowDimensions.w?t.css({left:s.offsetWidth}):t.css({left:0-s.offsetWidth})}}},i.fn.nav=function(t){return this.each(function(){i.data(this,e)||i.data(this,e,new n(this,t))})}})(document,jQuery);